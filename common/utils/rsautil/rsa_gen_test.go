package rsautil

import "testing"

var priKey = "MIIEwAIBADANBgkqhkiG9w0BAQEFAASCBKowggSmAgEAAoIBAQDNQsAbxqu1KYHdFqA8W5HQot1uEV1S99HxHoo26IcnYxswfz1vjD4fQRh9Te6BrhcXGPQ1DbNg//0ZcO1NqvjlFV+yrhYO3c51NQLs5CxSx4R0bTmo4suzWVjANbz+sXG4/vXb3YzBDfnLOHclSF46LDJtsjbUMnE1OVjfflM1fTwmeYaoLNI76B2QTB+jCBwEH89ua+HMDk+RCc0xB7IEazGnX0CbVikbLEnIb7YvKxMnnIRRREn+bt3t0cGXHE6wuwIfhsIcEeEN49EbsQqW6K0lnijzIvguhSN25UCrbyH6NPe/2Umnylqk6yEOaPJRIbGnnBsQ9bWMgPuRDO5hAgMBAAECggEBAIwwz/bonTQRkmHHZ09yF0hRRD093Oii3B/8BNh1voGXPeXEsdgzB+be1fQXOxQVLC4ZXAm0PtS8YkhzCZDnejE0hPUL04L52V3SBBp5yRAMtxmx1BTWOdxX5Lb6vQeTeCGq+Y7eZZkhi39SJIYxRDIlJ5gmhS4u+YUpktqqc/huQyciLG+oBDbEXgZ2RuXiMQZ9aZrBxhjkR4xCvHpodcCnNa0KFCCzrNeQ5RD4vquHATx1EywptlaNEIK9rbTaBAtRYYuL8JCtGQtqnoSCmLe5+vQPfrCjJU/HS+X7HkcBvoDPm/T6XHHT1yUxY9Lb1Jw3ZYPPvM800U76fGmMITECgYEA0RK7gC1q0td1b6GtnL34wR8MTOKkOL0k5EXRMcf80kixJBccGwyvYw0qWj7W2R5X6y9y2FZAtlHy7OICE3qz4lt7PAHmj4aX9sVRJgwsRrd+hFrUnEGi+X60/5NA22Yfhyty4n79KlUds8MHHt8H6fpelgBZ3d1nw7HvveOp6e0CgYEA+1T1Cpe3sq5dux8oJ6A2AaFf8RBpyQOBY47slRb3NdA1KfsrDmPGd3ny4QRcuj7K29xJCdIjmJ0bxB3gmFuJ6nDdcX/nIJTztWCZ+lFEQZjzCNx66rYq94PnHFC5wWyup+4grlTzJsM7z5p1rw9TFKKToNNC5iGyAeol1izyN8UCgYEAntDC+4gEiGrAu26uSc2JA3JJTrIvGyaauohKc6094KL1ZLvlTqrhI7XhgTIQ1FcXZADkFW/XsmcnyEeaWh+wO3dQcnHjKQ2NrBeRH/zJOWKzyWiR7qxxV2KnrSi3cLHvqycXGvRp7VlAucehRhMXmOXmKb3UhhNkeiRVQAKLlLUCgYEA3ovw2utS9v4c8yd4l/XuPG1Xlg6xjRP0i2KwLKgESHtPyBemnXxN7ddm8Ea7kRMu75XUesS/TlC3mGXYTTCpI5XDD9BwqVIbppyeW5+AMBGuCkeo85JQ45DBoTn98b85vGtINvXzxHwVxxN/Z37LUzdOP5cx4rMtezKJRGfSJv0CgYEAhzPiZxagohqDeiXokwc5XZJQfXdps0jMBsLl71qV5O0fQuTDzHyp5Dn1HUOw8MejMjvzv87FHqHr7/oKiWSYI0Fj9l8iPLSc24Lxqr6BxgUOCelzK451EtJQpMmKNFnjtiqtg1mRNTrxw2o9mSsi6+DK9Kn1mF8HyvwS/axocJc="
var pubKey = "MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAzULAG8artSmB3RagPFuR0KLdbhFdUvfR8R6KNuiHJ2MbMH89b4w+H0EYfU3uga4XFxj0NQ2zYP/9GXDtTar45RVfsq4WDt3OdTUC7OQsUseEdG05qOLLs1lYwDW8/rFxuP71292MwQ35yzh3JUheOiwybbI21DJxNTlY335TNX08JnmGqCzSO+gdkEwfowgcBB/PbmvhzA5PkQnNMQeyBGsxp19Am1YpGyxJyG+2LysTJ5yEUURJ/m7d7dHBlxxOsLsCH4bCHBHhDePRG7EKluitJZ4o8yL4LoUjduVAq28h+jT3v9lJp8papOshDmjyUSGxp5wbEPW1jID7kQzuYQIDAQAB"

func TestGenRsaKey(t *testing.T) {
	err := GenRsaKey(2048)
	t.Log(err)
}

func TestRsa(t *testing.T) {
	pri, err := ParseRsaPrivateKeyFromBase64(priKey)
	t.Log(pri, err)
	pub, err := ParseRsaPublicKeyFromBase64(pubKey)
	t.Log(pub, err)
	// sha1 签名
	sign, err := RsaSignStringOutBase64("123456", pri)
	t.Log(sign, err)
	// 验证签名
	err = RsaCheckSign("123456", sign, pub)
	t.Log(err)
	err = RsaCheckSign("123456", "Hj4tgnZl6oUNmABL+OoJot4a8lwEiTitXsubupiaeKXdKTk9hCQkM2JSP7SgmK0lhiM5FpDVpLyeeqweORqyoUbp60BmRQ/xhA3hWGpNEqCnttzb3DOdteJH7wO5o8dOuXmn1y1OETK5pi0U6cVfDM4FJKU0pKr6fwyz+/aP4/+At42ivJmLNTQcj8mx/YPxCVE/FVwZy9ynSqWaHxSVHVNDi3cWw2GPxKNvtY0+GlsWaqKL8iiWsorM4H2d4+BU9zBcqRoxjmLywUuY4ohuBeYyjdigfboJu6ZWAJjH8m35T5GLohKE0aXdxOq8aS8PQXB4U1bOrLpwz737uoKdKg==", pub)
	t.Log(err)

	err = RsaCheckSign("123456", "Hj4tgnZl6oUNmABL+OoJot4a8lwEiTitXsubupiaeKXdKTk9hCQkM2JSP7SgmK0lhiM5FpDVpLyeeqweORqyoUbp60BmRQ/xhA3hWGpNEqCnttzb3DOdteJH7wO5o8dOuXmn1y1OETK5pi0U6cVfDM4FJKU0pKr6fwyz+/aP4/+At42ivJmLNTQcj8mx/YPxCVE/FVwZy9ynSqWaHxSVHVNDi3cWw2GPxKNvtY0+GlsWaqKL8iiWsorM4H2d4+BU9zBcqRoxjmLywUuY4ohuBeYyjdigfboJu6ZWAJjH8m35T5GLohKE0aXdxOq8aS8PQXB4U1bOrLpwz737uoKdKg==", pub)
	t.Log(err)
}
